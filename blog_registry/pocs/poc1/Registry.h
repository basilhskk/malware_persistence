#pragma once
#include <Windows.h>

namespace winapi4humans {

	class Registry
	{
	public:

		static const int MAX_KEY_LENGTH = 255;
		static const int MAX_VALUE_NAME = 16383;

		static long createKey(HKEY hive, LPCWSTR path);


			
		static long readValue(HKEY hive, LPCWSTR path, LPCWSTR name, DWORD32* data);

		static long readValue(HKEY hive, LPCWSTR path, LPCWSTR name, DWORD64* data);

		static long readValue(HKEY hive, LPCWSTR path, LPCWSTR name, LPCSTR* data, LPDWORD size);

		static long readValue(HKEY hive, LPCWSTR path, LPCWSTR name, LPCWSTR* data, LPDWORD size);

		static long readValue(HKEY hive, LPCWSTR path, LPCWSTR name, LPBYTE* data, LPDWORD size);



		static long writeValue(HKEY hive, LPCWSTR path, LPCWSTR name, DWORD type, DWORD32 data);

		static long writeValue(HKEY hive, LPCWSTR path, LPCWSTR name, DWORD type, DWORD64 data);

		static long writeValue(HKEY hive, LPCWSTR path, LPCSTR name, DWORD type, LPCSTR data, DWORD size);

		static long writeValue(HKEY hive, LPCWSTR path, LPCWSTR name, DWORD type, LPCWSTR data, DWORD size);

		static long writeValue(HKEY hive, LPCWSTR path, LPCWSTR name, LPBYTE data, DWORD size);
		


		static long writeKeyValue(HKEY hive, LPCWSTR path, LPCWSTR name, DWORD type, DWORD32 data);

		static long writeKeyValue(HKEY hive, LPCWSTR path, LPCWSTR name, DWORD type, DWORD64 data);

		static long writeKeyValue(HKEY hive, LPCWSTR path, LPCSTR name, DWORD type, LPCSTR data, DWORD size);

		static long writeKeyValue(HKEY hive, LPCWSTR path, LPCWSTR name, DWORD type, LPCWSTR data, DWORD size);

		static long writeKeyValue(HKEY hive, LPCWSTR path, LPCWSTR name, LPBYTE data, DWORD size);



		static long deleteKey32(HKEY hive, LPCWSTR path);

		static long deleteKey64(HKEY hive, LPCWSTR path);


	private:

		static long openKey(HKEY hive, LPCWSTR path, REGSAM perms, HKEY* key);

		static long readValue(HKEY hive, LPCWSTR path, LPCWSTR name, DWORD type, LPBYTE data, LPDWORD size);

		static long writeValueA(HKEY hive, LPCWSTR path, LPCSTR name, DWORD type, LPBYTE data, LPDWORD size);

		static long writeValueW(HKEY hive, LPCWSTR path, LPCWSTR name, DWORD type, LPBYTE data, LPDWORD size);

		static long writeKeyValueA(HKEY hive, LPCWSTR path, LPCSTR name, DWORD type, LPBYTE data, LPDWORD size);
		
		static long writeKeyValueW(HKEY hive, LPCWSTR path, LPCWSTR name, DWORD type, LPBYTE data, LPDWORD size);

		static long closeKey(HKEY& key);

	};
};
